\chapter{Моделирование уравнения Смолуховского.}
\section{Алгоритм моделирования.}
В работах Королева-Яницкого было впервые предложено использовать схему испытаний Бернулли для 
моделирования химических реакций. Как показали численные эксперименты, расчеты можно проводить при
небольшом числе частиц и избежать сильного влияния квадратичной зависимости. С другой стороны
 в задачах кластерообразования в результате взаимодействия частиц возникает множество сортов кластеров
 различающихся по массам и диаметрам и в расчетах приходится сталкиваться с проблемой квадратичной 
 зависимости от количества реагирующих смесей. Для решения этой проблемы можно использовать не
 фиксированные сорта частиц, а переменные: наряду с индивидуальными характеристиками частицы, такими как
 скорость или вес, можно использовать и сорт, к которому она принадлежит. 
 
 
 Рассмотрим эту схему для моделирования дискретного уравнения Смолуховского. Будем решать задачу Коши следующего вида:

\begin{equation}
\left\{ \begin{split}
	&\frac{\partial n(l, t)}{\partial t} = \frac{1}{2}\sum_{i=1}^{l-1}K(l-i, i) n(i, t) n(l-i,t) - \sum_{i=1}^{\infty} K(l, i) n(l, t) n(i, t) \\
	&n(l, 0) = \phi(l)
	\end{split}
\right.
\end{equation},

где $n(l, t)$ - концентрация кластеров, состоящих из $l$ частиц в момент времени $t$, а $K(x, y)$ - ядро коагуляции,
которое определяет скорость с которой частицы размером $x$ взаимодействуют с частицами размером $y$. Из физических
соображений полагают, что $K(x, y) = K(y, x)$.

Для удобства изложения введем следующие термины. Модельная частица $p$ - это пара чисел $(l, w)$, где $l \in \mathbb{N}$ - 
определяет размер кластеров, которые представляет модельная частица, а $w \in \mathbb{R}_{+}$ - определяет ее вес, 
т.е. количество кластеров, которые она представляет.
$l(p)$ - функция, возвращающая размер кластеров, которые представляет модельная частица $p$
$w(p)$ - функция, возвращающая вес $p$.

Ячейкой размером $M$ назовем множество $P = \{p_i, i = 1..M\}$ из $M$ частиц. Концентрацией кластеров размером $l$ в данной 
ячейке будет функция $n(l) = \sum_{i=1}^{N}w(p_i) [ l(p_i) = l]$. $[x]$ - нотация Айверсона, равная 1, если выражение 
$x$ - истинно и 0, если ложно.

Реализация схемы Бернулли - множество ячеек из $M$ модельных частиц, проиндексированных параметром $t \in T$.

Столкновение двух частиц - функция, отображающая частицы $x$ и $y$ в себя следующим образом(для удобства $w(x) < w(y))$:
\begin{equation*}
\left(
\begin{split}
w(x), l(x)\\
w(y), l(y)
\end{split}\right)
\rightarrow
\left(
\begin{split}
& w(x),& l(x) + l(y)\\
& w(y) - w(x),& l(x)
\end{split}\right)
\end{equation*}

Суммарная масса частиц при этом не меняется.
\section{Исследование соответствия уравнению Смолуховского}
\section{Анализ дисперсии весов}
\section{Сравнительный расчет }
\section{Многокомпонентное уравнение Смолуховского}
\section{Сравнительный расчет}
