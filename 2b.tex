\section{Исследование соответствия весовой схемы Бернулли пространственно-неоднородному уравнению Больцмана.}

Для анализа соответствия весовой схемы Бернулли уравнению Больцмана рассмотрим отдельные этапы алгоритма и покажем,
что они соответствуют разностным операторам столкновительной релаксации и пространственного сдвига.


Без ограничения общности рассмотрим изменение функции распределения $\phi_l(x, v, t)$ частиц сорта $l$ в результате пространственного сдвига 
для одномерной задачи. Уход частиц из ячейки $x_i$, обладающих скоростью $v > 0$ за время $\Delta t$ будет равен:
$$
J_{move}^-(x_i, v, t) = \phi_l(x_i, v, t) \cdot \frac{v \Delta t}{\Delta x}
$$

С другой стороны за время $\Delta t$ из ячейки $x_{i-1}$ в ячейку $x_i$ перейдет:
$$
J_{move}^+(x_i, v, t) = \phi_l(x_{i-1}, v, t) \cdot \frac{v \Delta t}{\Delta x}
$$
В результате количество частиц в ячейке $x_i$ на шаге $t+\Delta t$ будет:
\begin{align*}
\phi_l(x_i, v, t+\Delta t) = \phi_l(x_i, v, t) + J_{move}^+(x_i, v, t) - J_{move}^-(x_i, v, t) = \\
\phi_l(x_i, v, t) - \frac{v \Delta t}{\Delta x} [\phi_l(x_{i}, v, t) - \phi_l(x_{i-1}, v, t)]
\end{align*}
\begin{align}
\frac{\Delta_t \phi_l(x_i, v, t)}{\Delta t} +  \frac{v \Delta_x \phi_l(x_{i}, v, t)}{\Delta x} = 0
\end{align}

Выражение (1) соответствует разностному оператору свободномолекулярного течения. 


Рассмотрим изменение функции распределения частиц за счет столкновительной релаксации. С целью упрощения дальнейших исследований интегралов
столкновений, будем использовать понятия, впервые введенные в работе\cite{Vallander1960}:
\begin{enumerate}
\item Рождением частицы называется последнее, испытанное ею столкновение, в результате которого она приобрела имеющуюся у нее скорость.
\item Функцией рождения $\Phi$ будем обозначать такую функцию аргументов $\vec c$ и $t$, что величина 
$$ d P = \Phi(\vec c, t) dV\,d\vec c\, dt$$
это вероятность рождения частицы в течении промежутка времени $(t, t + d t)$ в элементе объема $d V$ и имеющей скорость из $d\vec c$;
\item Внутренней ударной трансформантой $T$ называется функция трех векторов скоростей, обладающая тем свойством, что
величина 
$$ dP = T_{lm}(\vec c_l, \vec c_m, \vec c) d \vec c$$
является вероятностью случайного события, состоящего в том, что в результате достоверно имевшего место столкновения 
двух частиц сортов $l$ и $m$ со скоростями $\vec c_l$ и $\vec c_m$, после столкновения частица сорта $l$ имеет скорость
в элементе $d \vec c$ пространства скоростей.
\item $A_{lm}$ - событие, состоявшее в том, что частица сорта $l$ изменила свою скорость в результате столкновения с
одной из частиц сорта $m$, при условии, что скорость данной частица сорта $l$ до столкновения была $\vec c$.
\end{enumerate}


Отметим, что функция $T$ имеет смысл условной плотности распределения скорости $\vec c$ частицы сорта $l$ после ее
столкновения с частицей сорта $m$, имевших до столкновения скорости $\vec c_l$ и $\vec c_m$ соответственно. 
$P(A_{lm}/\vec c)$ - условная вероятность события $A_{lm}$, при условии $\vec c_l = \vec c$. 


На основании \cite{Vallander1960}, в новых обозначениях интеграл столкновений будет выглядеть следующим образом:
$$
I[\phi_l, \phi_l] = \Phi_l(t, \vec c_l) - \sum_{m=1}^{s} \int \phi_l \phi_m g_{lm} d\sigma_{lm}^{(e)} d \vec c_m,
$$
где
$$
\Phi_l (t, \vec c) = \sum_{m=1}^{s}n_m \int g_{lm}^{,} \phi_l^{,} \phi_{m}^{,} T_{lm}(\vec c_{l}^{,}, \vec c_{m}^{,}, \vec c_l) \sigma_{lm}^{,(e)} d\vec c_l^{,}d\vec c_{m}^{,}.
$$


Пусть $P_1(\vec c)$ - вероятность того, что частица сорта $l$ имела скорость $\vec c_l = \vec c$ и не изменила ее за 
время $\Delta t$. $P_2(\vec c)$ - вероятность того, что частица сорта $l$ имела некоторую скорость 
$\vec c_{l}^{,} = \vec c^{,}$ в момент $t$ и за время $\Delta t$ изменила ее на $\vec c$ в результате 
столкновения с одной из частиц сорта $m$.

Обозначим 
$$N^{,} = 
\left\{ \begin{array}{l l} 
N & m \neq l\\
N-1 & m = l\\
\end{array}\right.$$

Тогда алгоритм моделирования столкновений с весовыми множителями дает следующие выражения для 
данных вероятностей:
\begin{align*}
P_1(\vec c) = \phi_l(t, \vec c)[1-p(A_{lm}/\vec c)] = \\
= \phi_l(t, \vec c) - \Delta t \sum_{j=1}^{N'}\int W_{lm}w_{lm}\phi_{lm}(t, \vec c, \vec c_m') = \\
= \phi_l(t, \vec c) - \Delta t N' \int W_{lm} w_{lm} \phi_{lm}(t, \vec c, \vec \xi) d \vec \xi,
\end{align*}
где $W_{lm} = \frac{n_m}{n_{lm}}$ - вероятность того, что частица $\vec c_l$ изменила свою скорость в результате
столкновения с частицей сорта $m$, при условии, что данное столкновения достоверно произошло. Подставляя
выражение для частоты столкновений, задаваемое формулой (1.2.1) получаем:
$$
P_1(\vec c) = \phi_l(t, \vec c) - \Delta t n_m \int |\vec c - \vec \xi| \sigma_{lm}^{(e)} \phi_{lm}(t, \vec c, \vec \xi) d\vec \xi.
$$

Аналогично получаем выражение для вероятности $P_2(\vec c)$:
\begin{align*}
P_2(\vec c) = \Delta t \sum_{j=1}^{N'} \int W_{lm} w_{lm}T_{lm}(\vec c',\vec c_m^{'j},\vec c) \phi_{lm}(t, \vec c',\vec c_m^{'j})d \vec c' d\vec c_m^{'j} = \\
= \Delta t n_m \int|\vec c' - \vec \xi'| \sigma_{lm}^{'(e)} T_{lm}(\vec c^{'}, \vec \xi^{'}, \vec c) \phi_{lm}(t, \vec c^{'}, \vec \xi^{'}) d\vec \xi^{'} d \vec c^{'}
\end{align*}

Частица сорта $l$ может иметь скорость $\vec c$ в момент времени $t + \Delta t$ лишь в результате осуществления двух
несовместных событий с вероятностями $P_1$ и $P_2$, т.е.:
\begin{align*}
\phi_l(t+\Delta t, \vec c) = P_1(\vec c) + P_2(\vec c) = \\
\phi_l(t, \vec c) + n_m \Delta t [J^{+}_{lm}(\phi_{lm}, \vec c) - J^{-}_{lm}(\phi_{lm, \vec c})]
\end{align*}

Перенося $\phi_l(t, \vec c)$ в левую часть, разделив на $\Delta t$ и суммируя по всем типам столкновений, получаем:
\begin{align*}
\frac{\Delta \phi_l(t, \vec c)}{\Delta t} = \sum_{m=1}^{S}n_m[J^{+}_{lm}(\phi_{lm}, \vec c) - J^{-}_{lm}(\phi_{lm}, \vec c)],\\
J^{+}_{lm}(\phi_{lm}, \vec c) = \\
J^{-}_{lm}(\phi_{lm}, \vec c) = \\
\end{align*}

С учетом принципа детального баланся в случае упругих взаимодействий, а также смысла трансформанты\cite{Barancev1963,Sherbak1972}, получаем выражения интегралов столкновений, аналогичные (1.1.1) с точностью до величины статистической зависимости частиц.

Следовательно, предлагаемая схема моделирования с весовыми множителями, с точностью до величины статистической зависимости частиц, реализует случайный процесс для интегро-разностной схемы (1.2.2) уравнения Больцмана (1.1.1). В работе \cite{Aristov_1996} показано, что подобная разностная схема является устойчивой и аппроксимирует решение уравнения Больцмана с первым порядком точности.

Заметим, что статистическая независимость частиц(принцип молекулярного хаоса) допускает представление двухчастичных 
функций распределения как произведения двух одночастичных функций распределения. При моделировании течений это 
предположение хорошо выполняется\cite{BelErofYanit1980,BelYanitsky1975_1, BelYanitsky1975_2}, но при решении пространственно-однородных задач требуется применять специальные
приемы ослабления зависимости частиц.

Таким образом, установлена степень соответствия уравнению Больцмана модели, в которой имеет место соблюдение законов
сохранения "в среднем". На основании этого можно сделать вывод, что соблюдение "детальной" консервативности не является
необходимым для данного соответствия. Достаточным условием является выполнение в модели консервативности на 
уровне математического ожидания.

Математическое ожидание веса новых частиц со
скоростью $v$ за время $\Delta t$ будет:
$$
J_{col}^+(v, x_i, t) = \sum_{i=1}^{N-1}\sum_{j=i+1}^{N}p_{ij}\min(w_i, w_j)[c_]
$$

