\section{Консервативность в схеме моделирования испытаниями Бернулли с весами.}

Рассмотрим процесс упругого взаимодействия двух частиц $A_l$ и $A_m$ различных сортов $l$ и $m$.
Пусть все частицы группы $A_l$ имеют скорость $\vec c_l$ и общее количество частиц $n_l$, а $A_m$ соответственно $\vec c_m$ и $n_m$.
В силу парности взаимодействия при столкновениях, со всей группой $A_l$ провзаимодействует лишь равная ей по численности подгруппа из
множества $A_m$. Скорости столкнувшихся частиц станут равными $c_l^{'}$ и $c_m^{'}$ соответственно. При этом полный импульс и 
энергия группы частиц $A_m$ станут равными:
\begin{align*}
&\vec P_m = m_m(n_l\vec c_m^{'} + (n_m - n_l) \vec c_m)\\
&E_m = \frac12 m_m(n_l |\vec c_m^{'}|^2 + (n_m - n_l)|\vec c_m|^2)
\end{align*}
Пусть при моделировании данного процесса столкновения схемой с весовыми множителями каждая группа молекул $A_l$ и $A_m$ представляется
одной модельной частицей. Следуя алгоритму моделирования, образующаяся после столкновения ``смесь''\, сорта $m$, по-прежнему
представляется в модели одним значением скорости. С вероятностью $n_l/n_m$ скорость всех частиц группы $A_m$ принимается равной
$\vec c_m^{'}$ и с вероятностью $1 - n_l/n_m$ у всех частиц данной группы остается прежнее значение скорости $\vec c_m$.
Таким образом, использование весовых множителей при моделировании столкновений двух различных по величине групп частиц приводит к 
нарушению законов сохранения. С вероятностью $n_l/n_m$ импульс и энергия большой группы частиц $A_m$ становятся равными:
\begin{align*}
 &\vec P_m^{(1)} = m_m\,n_m \vec c_m^{'}\\
 & E_m^{(1)} = \frac12 m_m\,n_m |\vec c_m^{'}|^2
\end{align*}
и с дополнительной вероятностью $1 - n_l/n_m$ они сохраняют свои прежние значения:
\begin{align*}
 &\vec P_m^{(2)} = m_m\,n_m \vec c_m\\
 & E_m^{(2)} = \frac12 m_m\,n_m |\vec c_m|^2
\end{align*}

Вычислим математическое ожидание значений импульса и энергии, реализуемые весовым алгоритмом:
\begin{align*}
 \mathbb{E}&[\vec P_m] = \frac{n_l}{n_m} \vec P_m^{(1)} + \left(1 - \frac{n_l}{n_m}\right)\vec P_m^{(2)} = \\
 &= m_m(n_l\vec c^{'} + (n_m - n_l)\vec c_m) \equiv \vec P_m\\
 \mathbb{E}&[\vec E_m] = \frac{n_l}{n_m} E_m^{(1)} + \left( 1 - \frac{n_l}{n_m}\right)E_m^{(2)} = \\
 &= \frac12 m_m(n_l |\vec c_m^{'}|^2 + (n_m - n_l) |\vec c_m|^2) \equiv E_m
\end{align*}

Следовательно, использование весовой схемы приводит к нарушению детальной консервативности системы, однако
при этом соблюдается консервативность на уровне математического ожидания.


Практические расчеты\cite{KorThesis} дали возможность проверить правильность теоретических выводов и оценить степень выполнения 
законов сохранения в среднем. При детальной консервативности общая температура моделируемой смеси остается постоянной. Использование 
весовых множителей приводит к тому, что условие сохранения энергии не выполняется. При расчетах по схеме DSMC введение весов
приводило к флуктуации температуры, причем уровень этой флуктуации составлял примерно 2\%.


