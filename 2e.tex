\section{Алгоритм моделирования процессов кластерообразования в весовой схеме
Бернулли.}

В соответствии с наиболее распространенными вычислительными схемами DSMC\cite{BIRD_1981,Vanag_UFN,Klyackin_2003,Kolesnichenko_200}, каждый компонент на протяжении всего времени моделирования представлен набором частиц с равными  массами  $m$ и диаметрами $d$. Поэтому принципиально новой, на наш взгляд, является расчётная схема, в которой для описания процессов кластерообразования в рамках весового подхода вводятся модельные частицы с дополнительными индивидуальными характеристиками: переменными во времени массами $m_i$ и диаметрами $d_i$. Таким образом, список персональных характеристик каждой модельной частицы пополнился ещё двумя и стал равен (в 3-х мерном случае) шести $(w_i, m_i, d_i, c_{xi}, c_{yi}, c_{zi})$. 


В дальнейшем, без ограничения общности, в случае взаимодействия модельных частиц $A_i$ и $A_n$ с относительной энергией $ER$, меньше порогового значения $EP$, предусмотрена возможность  моделирования конденсации (слипания двух подмножеств реальных молекул равной мощности), испарение с поверхности кластера молекул, разрушение кластера при столкновении, а также переход кинетической энергии столкновения во внутренние степени свободы. Вводится пороговая функция $\sigma_k$, которая определяет условие реализации слипания. В общем случае, при кластерообразовании могут реализовываться различные типы  взаимодействий в зависимости от начальных условий: 
Например, если 
\begin{equation}
 \sigma_k = \left\{ \begin{array}{ccc}
 0&\text{, при}&ER>EP\\
 \\
 1&\text{, при}&ER<EP
\end{array}
\right.
\end{equation}
и $w = \min(w_l, w_n)$, то получим реакцию типа $2\rightarrow2$.
В другом возможном случае при
\begin{equation}
 \sigma_k = \left\{ \begin{array}{ccc}
 0&\text{, при}&ER>EP\\
 \\
 1 - \dfrac{ER}{EP}&\text{, при}&ER<EP
\end{array}
\right.
\end{equation}
и $w < \min(w_l,w_n)$ получаем более сложную комбинацию типа $2\rightarrow3$.


Весовой подход позволяет реализовать все сценарии от полного слипания (тип $2\rightarrow1$) до образования многочисленных осколков (тип $2 \rightarrow S$, $S > 2$). 
Ограничимся подробным рассмотрением схемы типа $2 \rightarrow 2$. 


Принципиальным моментом процедуры моделирования коалисценции частиц является пересчёт значений масс, диаметров и скоростей вновь образованных объектов. 
Пусть $\min(w_l,w_n)=w_n$. Предлагается такая последовательность действий:
\begin{description}
 \item[Шаг 1.] Вес большего представителя $A_l$ уменьшается на величину, соответствующую доле слипшихся реальных молекул,
$$w_l^* = w_l - w_n,$$
при этом масса, диаметр и скорость частицы $A_l^*$ остаются неизменными.
 \item[Шаг 2.] Вес частицы $A_n$ остаётся неизменным. Новые значения скоростей получаются из условия сохранения импульса. Новое значение массы:
$$m_n^* = m_l + m_n$$
В данном случае возможны три варианта пересчёта значения диаметра вновь образовавшегося конгломерата:
\begin{description}
 \item$d = d_l+d_n$ - некоторый аналог «ленточного кластера».
 \item$d = \sqrt{d_l^2 + d_n^2}$ - плоское «пятно».
 \item$d = \sqrt[3]{d_l^3 + d_n^3}$ - «комок».
\end{description}

\end{description}
В схему моделирования кластеров было добавлено условие потери части энергии частицами при слипании.
 
